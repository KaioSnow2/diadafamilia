<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprar Produtos - Dia da Família</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Estilos adicionais para a tabela de produtos */
        .container {
            max-width: 800px;
            margin: auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        th {
            background-color: #f2f2f2;
            font-weight: bold;
        }
        .produto-item h3 {
            margin: 0;
            font-size: 1.1em;
        }
        .produto-item p {
            margin: 0;
            color: #777;
            font-size: 0.9em;
        }
        .quantidade-input {
            width: 60px;
            padding: 8px;
            text-align: center;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        .total {
            margin-top: 20px;
            text-align: right;
            font-size: 1.5em;
            font-weight: bold;
        }
        .botao-principal {
            display: block;
            width: 100%;
            padding: 15px;
            text-align: center;
            background-color: #28a745;
            color: white;
            text-decoration: none;
            font-size: 1.2em;
            border-radius: 5px;
            margin-top: 20px;
            transition: background-color 0.3s ease;
        }
        .botao-principal:hover {
            background-color: #218838;
        }
    </style>
</head>
<body>

    <header>
        <h1>Dia da Família na Escola</h1>
        <p>Produtos disponíveis para compra</p>
    </header>

    <main>
        <div class="container">
            <h2>Cardápio e Vendas</h2>
            
            <table>
                <thead>
                    <tr>
                        <th>Produto</th>
                        <th>Preço Unitário</th>
                        <th>Quantidade</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>CAFÉ</h3>
                            </div>
                        </td>
                        <td>R$ 6,00</td>
                        <td><input type="number" value="0" min="0" data-preco="6.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>CUCA</h3>
                            </div>
                        </td>
                        <td>R$ 6,00</td>
                        <td><input type="number" value="0" min="0" data-preco="6.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>COMBO (CAFÉ E CUCA)</h3>
                            </div>
                        </td>
                        <td>R$ 10,00</td>
                        <td><input type="number" value="0" min="0" data-preco="10.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>MINI PIZZA</h3>
                                <p>(compra antecipada)</p>
                            </div>
                        </td>
                        <td>R$ 7,00</td>
                        <td><input type="number" value="0" min="0" data-preco="7.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>REFRI 200ml</h3>
                            </div>
                        </td>
                        <td>R$ 3,00</td>
                        <td><input type="number" value="0" min="0" data-preco="3.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>ÁGUA COM GÁS</h3>
                            </div>
                        </td>
                        <td>R$ 2,50</td>
                        <td><input type="number" value="0" min="0" data-preco="2.50" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>ÁGUA</h3>
                            </div>
                        </td>
                        <td>R$ 2,00</td>
                        <td><input type="number" value="0" min="0" data-preco="2.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>MORENINHA</h3>
                            </div>
                        </td>
                        <td>R$ 5,00</td>
                        <td><input type="number" value="0" min="0" data-preco="5.00" oninput="calcularTotal()"></td>
                    </tr>
                    <tr>
                        <td>
                            <div class="produto-item">
                                <h3>SORVETINHO</h3>
                            </div>
                        </td>
                        <td>R$ 2,00</td>
                        <td><input type="number" value="0" min="0" data-preco="2.00" oninput="calcularTotal()"></td>
                    </tr>
                </tbody>
            </table>

            <div class="total">
                Total da Compra: <span id="preco-total">R$ 0,00</span>
            </div>

            <a href="finalizar_compra.html" class="botao-principal">Finalizar Compra</a>
        </div>
    </main>

    <script>
    function calcularTotal() {
        let precoTotal = 0;
        const carrinho = [];
        const camposQuantidade = document.querySelectorAll('input[type="number"]');

        camposQuantidade.forEach(campo => {
            const precoUnitario = parseFloat(campo.getAttribute('data-preco'));
            const quantidade = parseInt(campo.value) || 0;
            const nomeProduto = campo.closest('tr').querySelector('h3').textContent.trim();
            
            // Adiciona o item ao carrinho apenas se a quantidade for maior que zero
            if (quantidade > 0) {
                carrinho.push({
                    nome: nomeProduto,
                    quantidade: quantidade,
                    precoUnitario: precoUnitario
                });
            }

            precoTotal += precoUnitario * quantidade;
        });

        // Salva o carrinho no localStorage para ser usado na próxima página
        localStorage.setItem('carrinho', JSON.stringify(carrinho));

        const precoFormatado = precoTotal.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' });
        document.getElementById('preco-total').textContent = precoFormatado;
    }

    // Esta função lida com o botão de finalização da compra
    function lidarComFinalizarCompra(event) {
        const total = parseFloat(document.getElementById('preco-total').textContent.replace('R$', '').replace(',', '.'));
        
        if (total === 0) {
            event.preventDefault(); // Impede o redirecionamento
            alert('Por favor, selecione ao menos um item para continuar.');
        }
    }
    
    // Configura os eventos quando a página é carregada
    window.onload = function() {
        // Inicializa o cálculo total assim que a página é carregada
        calcularTotal();
        
        // Adiciona o evento de clique no botão "Finalizar Compra"
        document.querySelector('.botao-principal').addEventListener('click', lidarComFinalizarCompra);
        
        // Adiciona um listener para cada campo de quantidade para recalcular em tempo real
        const camposQuantidade = document.querySelectorAll('input[type="number"]');
        camposQuantidade.forEach(campo => {
            campo.addEventListener('input', calcularTotal);
        });
    };
</script>